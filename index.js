!function(t,e){"use strict";function n(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var i=n((function(e,n){e.exports=function(t){let e=class extends t.Texture{constructor(){super(document.createElement("canvas"));let e=null,n=()=>e||(e=this.createDrawable()),i=()=>n().width,o=()=>n().height,r=!0,a=1,l=()=>t.MathUtils.ceilPowerOfTwo(i()*a),s=()=>t.MathUtils.ceilPowerOfTwo(o()*a),f=t=>{if(a!==t){let e=l(),n=s();a=t;let i=l(),o=s();i===e&&o===n||(r=!0)}},c=(()=>{let e=new t.Vector3,n=new t.Vector3,r=new t.Vector3;return(t,a,l)=>{let s=i(),f=o();if(s&&f){t.getWorldPosition(n),l.getWorldPosition(e);let i=n.distanceTo(e);if(l.isPerspectiveCamera&&(i*=2*Math.tan(THREE.Math.degToRad(l.fov)/2)),(l.isPerspectiveCamera||l.isOrthographicCamera)&&(i/=l.zoom),i){var c,d;t.getWorldScale(r);let e=null!==(c=null===(d=a.capabilities)||void 0===d?void 0:d.maxTextureSize)&&void 0!==c?c:1/0;return Math.min(Math.max(r.x/i*(a.domElement.offsetWidth/s),r.y/i*(a.domElement.offsetHeight/f)),e/s,e/f)}}return 0}})();Object.defineProperties(this,{width:{get:i},height:{get:o},pixelRatio:{get:()=>a,set:f},needsRedraw:{set(t){t&&(r=!0,e=null)}}}),Object.assign(this,{redraw(){if(r){let t=this.image,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),t.width=l(),t.height=s(),t.width&&t.height?(e.save(),e.scale(t.width/i(),t.height/o()),((...t)=>{n().draw(...t)})(e),e.restore()):t.width=t.height=1,r=!1,this.needsUpdate=!0}},setOptimalPixelRatio(...t){f(c(...t))}})}};e.prototype.isDynamicTexture=!0;let n=class extends e{constructor({alignment:t="center",color:e="#fff",fontFamily:n="sans-serif",fontSize:i=16,fontStyle:o="normal",fontVariant:r="normal",fontWeight:a="normal",lineGap:l=1/4,padding:s=.5,strokeColor:f="#fff",strokeWidth:c=0,text:d=""}={}){super(),Object.entries({alignment:t,color:e,fontFamily:n,fontSize:i,fontStyle:o,fontVariant:r,fontWeight:a,lineGap:l,padding:s,strokeColor:f,strokeWidth:c,text:d}).forEach((([t,e])=>{Object.defineProperty(this,t,{get:()=>e,set(t){e!==t&&(e=t,this.needsRedraw=!0)}})}))}get lines(){let{text:t}=this;return t?t.split("\n"):[]}get font(){return function(t,e,n,i,o){let r=document.createElement("span");return r.style.font="1px serif",r.style.fontFamily=t,r.style.fontSize="".concat(e,"px"),r.style.fontStyle=n,r.style.fontVariant=i,r.style.fontWeight=o,r.style.font}(this.fontFamily,this.fontSize,this.fontStyle,this.fontVariant,this.fontWeight)}checkFontFace(){try{let{font:t,lines:e}=this;return e.every((e=>document.fonts.check(t,e)))}catch{}return!0}async loadFontFace(){try{let{font:t,lines:e}=this;return await Promise.all(e.map((e=>document.fonts.load(t,e))))}catch{}}createDrawable(){let{alignment:t,color:e,font:n,fontSize:i,lineGap:o,lines:r,padding:a,strokeColor:l,strokeWidth:s}=this;a*=i,o*=i,s*=i;let f=r.length,c=i+o,d=f?(()=>{let t=document.createElement("canvas").getContext("2d");return t.font=n,Math.max(...r.map((e=>t.measureText(e).width)))})():0,h=a+s/2,p=d+2*h;return{width:p,height:(f?i+c*(f-1):0)+2*h,draw(o){let a,f=h+i/2;Object.assign(o,{fillStyle:e,font:n,lineWidth:s,miterLimit:1,strokeStyle:l,textAlign:(()=>{switch(t){case"left":return a=h,"left";case"right":return a=p-h,"right"}return a=p/2,"center"})(),textBaseline:"middle"}),r.forEach((t=>{o.fillText(t,a,f),s&&o.strokeText(t,a,f),f+=c}))}}}};return n.prototype.isTextTexture=!0,n}(t)})),o=n((function(e,n){e.exports=function(t,e){function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=n(e);let o=class extends t.Sprite{constructor({fontSize:e=1,...n}={},o=new t.SpriteMaterial({depthWrite:!1})){super(o);let r=new i.default({fontSize:e,...n});this.material.map=r}onBeforeRender(t,e,n){let{material:i}=this,{map:o}=i;if(o.checkFontFace()){let{scale:e}=this,{height:i,width:r}=o;r&&i?(e.setX(r).setY(i),o.setOptimalPixelRatio(this,t,n),o.redraw()):e.setScalar(1)}else o.loadFontFace()}dispose(){let{material:t}=this,{map:e}=t;e.dispose(),t.dispose()}};return["alignment","color","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineGap","padding","strokeColor","strokeWidth","text"].forEach((t=>{Object.defineProperty(o.prototype,t,{get(){return this.material.map[t]},set(e){this.material.map[t]=e}})})),o.prototype.isTextSprite=!0,o}(t,i)})),r="text-sprite";t.MathUtils=t.MathUtils||t.Math,e.registerComponent(r,{init:function(){let{data:t,el:e}=this,{alignment:n,color:i,fontFamily:a,fontSize:l,fontStyle:s,fontVariant:f,fontWeight:c,lineGap:d,padding:h,strokeColor:p,strokeWidth:u,text:m}=t,g=new o({alignment:n,color:i,fontFamily:a,fontSize:l,fontStyle:s,fontVariant:f,fontWeight:c,lineGap:d,padding:h,strokeColor:p,strokeWidth:u,text:m});e.setObject3D(r,g)},remove:function(){let{el:t}=this;t.getObject3D(r).dispose(),t.removeObject3D(r)},schema:{alignment:{type:"string",default:"center"},color:{type:"color",default:"#fff"},fog:{type:"boolean",default:!1},fontFamily:{type:"string",default:"sans-serif"},fontSize:{type:"number",default:1},fontStyle:{type:"string",default:"normal"},fontVariant:{type:"string",default:"normal"},fontWeight:{type:"string",default:"normal"},lineGap:{type:"number",default:.15},opacity:{type:"number",default:1},padding:{type:"number",default:.25},strokeColor:{type:"color",default:"#000"},strokeWidth:{type:"number",default:0},text:{type:"string",default:""},transparent:{type:"boolean",default:!0}},update:function(t){let{data:e,el:n}=this,{alignment:i,color:o,fog:a,fontFamily:l,fontSize:s,fontStyle:f,fontVariant:c,fontWeight:d,lineGap:h,opacity:p,padding:u,strokeColor:m,strokeWidth:g,text:y,transparent:x}=e,w=n.getObject3D(r);Object.keys(t).length&&Object.assign(w,{alignment:i,color:o,fontFamily:l,fontSize:s,fontStyle:f,fontVariant:c,fontWeight:d,lineGap:h,padding:u,strokeColor:m,strokeWidth:g,text:y});let{material:S}=w;Object.assign(S,{fog:a,opacity:p,transparent:x})}})}(THREE,AFRAME);
